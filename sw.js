(()=>{"use strict";var e={13157:function(e,t,n){n.d(t,{PH:function(){return o},pl:function(){return r},vT:function(){return c}});let r="https://bryanjimenez.github.io/nmemonica-dev",o="/g_translate_pronounce",c="https://pronounce.bryanjimenez6.workers.dev"+o},26757:function(e,t,n){n.d(t,{Ho:function(){return i},pK:function(){return r},sH:function(){return a},xR:function(){return c},zg:function(){return s}});let r=Object.freeze({MEDIA:"media",STATE:"state",SETTINGS:"settings",WORKBOOK:"workbook"}),o=Object.freeze({NoResult:"IDBNoResults"});function c(){let{version:e,logger:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=indexedDB.open("nmemonica-db",e??1),o=new Promise(e=>{n.onupgradeneeded=function(t){if(null===t.target)throw Error("onupgradeneeded failed");let n=t.target.result;if(0===t.oldVersion){let t=n.createObjectStore(r.MEDIA,{keyPath:"uid"}),o=new Promise((e,n)=>{t.transaction.oncomplete=function(){e()}}),c=n.createObjectStore(r.STATE,{keyPath:"key"}),i=new Promise((e,t)=>{c.transaction.oncomplete=function(){e()}}),s=n.createObjectStore(r.SETTINGS,{keyPath:"key"}),a=new Promise((e,t)=>{s.transaction.oncomplete=function(){e()}}),u=n.createObjectStore(r.WORKBOOK,{keyPath:"key"});Promise.all([o,i,a,new Promise((e,t)=>{u.transaction.oncomplete=function(){e()}})]).then(()=>{e({type:"upgrade",val:n})})}}}),c=new Promise((e,r)=>{n.onerror=function(){"function"==typeof t&&t("IDB.open X(",1),r()},n.onsuccess=function(n){if(null===n.target)throw Error("openIDB failed");let r=n.target.result;r.onerror=function(e){if(e.target&&"errorCode"in e.target){let{errorCode:n}=e.target;"function"==typeof t&&t("IDB Open X(",1)}},e({type:"open",val:r})}});return Promise.any([o,c]).then(e=>"upgrade"===e.type?c.then(e=>e.val):e.val)}function i(e,t){let{db:n,store:c,logger:i}=e,s=r.MEDIA,a=n.transaction([c??s]),u=a.objectStore(c??s).get(t),l=new Promise((e,t)=>{u.onerror=function(){"function"==typeof i&&i("IDB.get X(",1),t()},u.onsuccess=function(){u.result?e(u.result):t(Error("No results found",{cause:{code:o.NoResult}}))}});return Promise.all([l,new Promise((e,t)=>{a.oncomplete=function(){e(void 0)},a.onerror=function(){t()}})]).then(e=>e[0])}function s(e,t){let{db:n,store:o}=e,c=r.MEDIA,i=n.transaction([o??c],"readwrite"),s=i.objectStore(o??c).add(t),a=new Promise((e,t)=>{s.onsuccess=function(){e(void 0)},s.onerror=function(){t()}});return Promise.all([a,new Promise((e,n)=>{i.oncomplete=function(){e(t)},i.onerror=function(){n()}})]).then(e=>e[1])}function a(e,t){let{db:n,store:o}=e,c=r.MEDIA,i=n.transaction([o??c],"readwrite"),s=i.objectStore(o??c).put(t),a=new Promise((e,t)=>{s.onsuccess=function(){e(void 0)},s.onerror=function(){t()}});return Promise.all([a,new Promise((e,n)=>{i.oncomplete=function(){e(t)},i.onerror=function(){n()}})]).then(e=>e[1])}Object.freeze({State:{EDITED:"localDataEdited"}})},22001:function(e,t,n){n.d(t,{PH:function(){return c},hY:function(){return o},zn:function(){return r}});let r=Object.freeze({CACHE_RELOAD:{"Cache-Control":"reload"},CACHE_NO_WRITE:{"Cache-Control":"no-store"},DATA_VERSION:"Data-Version"});Object.freeze({UI_LOGGER_MSG:"ui_logger_msg"});let o=Object.freeze({POST_INSTALL_ACTIVATE_DONE:"POST_INSTALL_ACTIVATE_DONE",SERVICE_WORKER_LOGGER_MSG:"service_worker_logger_msg"}),c=Object.freeze({SW_GET_VERSIONS:"SW_GET_VERSIONS",SW_REFRESH_HARD:"SW_REFRESH_HARD",DATASET_JSON_SAVE:"DATASET_JSON_SAVE"});Error("Service Worker not available")},32002:function(e,t,n){function r(e,t){return new URLSearchParams(e.includes("?")?e.split("?")[1]:"").get(t)}function o(e,t){let[n,r]=e.includes("?")?e.split("?"):[e,""],o=new URLSearchParams(r);return o.delete(t),[n,o.toString()].join("?")}n.d(t,{$5:function(){return o},jS:function(){return r}})},94397:function(e,t,n){n.d(t,{x6:function(){return r}});let r=Object.freeze({OFF:0,ERROR:1,WARN:2,DEBUG:3});Object.freeze({GROUP:0,FREQUENCY:1,TAGS:2}),Object.freeze({RANDOM:0,ALPHABETIC:1,DIFFICULTY:2,VIEW_DATE:3,RECALL:4}),Object.freeze({HIRAGANA:0,KATAKANA:1,MIXED:2})}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var c=t[r]={exports:{}};return e[r](c,c.exports,n),c.exports}n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};(()=>{var e=n(22001),t=n(26757),r=n(94397),o=n(32002),c=n(13157);let i=["341.bb2e03d8.js","961.71c34e57.css","911.b22a7988.js","629.dc4eaaa1.css","70.8c537e47.js","961.71c34e57.js","icon512_dev.png","43.06fec93e.js","icon192.png","927.59c8265f.css","favicon.ico","icon512.png","710.8168fa82.js","174.b1fcfebf.js","index.html","314.9f62200a.js","256.7c5bc923.js","voice-worker.js","main.ebb8d9ac.js","314.9f62200a.css","maskable512_dev.png","maskable512.png","18e32d9d743af28f913e.woff2","icon192_dev.png","629.dc4eaaa1.js","main.ebb8d9ac.css","927.59c8265f.js","manifest.webmanifest"],s=c.pl,a=c.vT,u=c.PH,l=globalThis.self;l.addEventListener("install",function(t){l.skipWaiting();let n=p();R(e.PH.SW_GET_VERSIONS,n)}),l.addEventListener("activate",function(e){"clients"in l&&l.clients.matchAll({includeUncontrolled:!0}).then(function(e){let t=e.map(function(e){return e.url});console.log("[ServiceWorker] Matching clients:",t.join(", ")),g("Matching clients:"+t.join(", "),r.x6.DEBUG)}),e.waitUntil(Promise.all([function(){return caches.keys().then(e=>Promise.all(e.reduce((e,t)=>[h,f,d].includes(t)?e:(console.log("[ServiceWorker] Deleting cache:",t),[...e,caches.delete(t)]),[])))}(),function(){return caches.open(f).then(e=>e.keys().then(t=>Promise.all(t.reduce((t,n)=>{let r=n.url.split("/").pop();return r&&r.indexOf(".")>-1&&!i.includes(r)?(console.log("[ServiceWorker] Removed static asset: "+r),[...t,e.delete(n.url)]):t},[]))))}()]).then(function(){return console.log("[ServiceWorker] Claiming clients"),g("Claiming clients",r.x6.DEBUG),l.clients.claim()}).then(()=>{let e=function(){let e=s+"/";return caches.open(f).then(t=>t.addAll([s,e])).catch(()=>{console.log("[ServiceWorker] / Prefectch failed for some item")})}();return Promise.all([e,caches.open(f).then(e=>e.addAll([...i])).catch(()=>{console.log("[ServiceWorker] Asset Prefectch failed for some item")})])}))}),l.addEventListener("fetch",function(n){if("OPTIONS"===n.request.method){n.respondWith(fetch(n.request));return}if("GET"!==n.request.method)return;let c=n.request.clone(),i=n.request.url,p=i.slice(i.indexOf("/",9));switch(!0){case i.includes("githubusercontent")&&c.headers.has(e.zn.DATA_VERSION):{let t=n.request.headers.get(e.zn.DATA_VERSION),r=caches.open(h).then(e=>e.match(i+".v"+t)).then(e=>{if(void 0===e)throw Error(`Missing ${i+".v"+t}`);return e});n.respondWith(r);break}case i.startsWith(s)&&!i.endsWith(".hot-update.json"):n.respondWith(function(e){return caches.open(f).then(t=>t.match(e)).then(t=>t||O(f,new Request(e)))}(i));break;case p.startsWith(u):{var S,R;let e=(0,o.jS)(i,"uid");if(!e)throw Error("Request missing uid");let s=(0,o.$5)(i,"uid"),u=c.url.startsWith(a)?new Request(s):c;"reload"===c.headers.get("Cache-Control")&&n.respondWith(function(e,n){if(console.log("[ServiceWorker] Overriding Asset in Cache"),!l.indexedDB)return console.log(E),g(E,r.x6.WARN),O(d,n);{g("IDB.override",r.x6.WARN);let o=fetch(n);return(0,t.xR)({logger:g}).then(n=>o.then(e=>{if(!e.ok)throw g("fetch",r.x6.ERROR),Error("Network response was not OK"+(e.status?" ("+e.status+")":""));return e.blob()}).then(r=>(0,t.sH)({db:n},{uid:e,blob:r}).then(e=>m(e))))}}(e,u)),n.respondWith((S=e,R=u,l.indexedDB?(0,t.xR)({logger:g}).then(e=>(0,t.Ho)({db:e,store:t.pK.MEDIA},S).then(e=>m(e)).catch(()=>(g("IDB.get [] ",r.x6.WARN),fetch(R).then(e=>{if(!e.ok)throw g("fetch",r.x6.ERROR),Error("Network response was not OK"+(e.status?" ("+e.status+")":""));return e.blob()}).then(n=>(0,t.zg)({db:e},{uid:S,blob:n}).then(e=>m(e)))))):(console.log(E),g(E,r.x6.WARN),function(e){return caches.open(d).then(t=>t.match(e)).then(t=>t||O(d,new Request(e)))}(R.url))));break}default:n.respondWith(fetch(n.request))}}),l.addEventListener("message",function(t){let n=t.data;if(n.type===e.PH.SW_REFRESH_HARD&&n.type===e.PH.SW_REFRESH_HARD){fetch(s+"/robots.txt").then(t=>{if(t.status<400)return caches.delete(f).then(()=>{l.registration.unregister(),R(e.PH.SW_REFRESH_HARD,{msg:"Hard Refresh",status:t.status})});throw Error("Service Unavailable")}).catch(t=>{R(e.PH.SW_REFRESH_HARD,{msg:"Hard Refresh",error:t})});return}if(n.type===e.PH.SW_GET_VERSIONS&&n.type===e.PH.SW_GET_VERSIONS){let t=p();R(e.PH.SW_GET_VERSIONS,t);return}g("Unrecognized message",r.x6.ERROR)});let f="nmemonica-static",h="nmemonica-data",d="nmemonica-media",E="Your browser doesn't support a stable version of IndexedDB.";function p(){return{swVersion:"bf46ea5b",jsVersion:"ebb8d9ac",bundleVersion:"ae19301f"}}function S(e){return fetch(e)}function m(e){return new Response(e.blob,{status:200,statusText:"OK"})}function R(e,t){"clients"in l&&l.clients.matchAll({includeUncontrolled:!0,type:"window"}).then(n=>{if(n&&n.length)return n[0].postMessage({type:e,...t})})}function g(t,n){"clients"in l&&l.clients.matchAll({includeUncontrolled:!0,type:"window"}).then(r=>{if(r&&r.length)return r[0].postMessage({type:e.hY.SERVICE_WORKER_LOGGER_MSG,msg:t,lvl:n})}).catch(e=>{console.log("[ServiceWorker] clientLogger failed"),console.log(e)})}function O(e,t){return caches.open(e).then(e=>fetch(t).then(n=>{if(!n.ok)throw Error("Could not fetch");return e.put(t.url,n)}).then(()=>e.match(t.url)).then(e=>{if(!e)throw Error("Could not recache");return e}).catch(()=>(console.log("[ServiceWorker] Network unavailable"),Promise.reject())))}})()})();