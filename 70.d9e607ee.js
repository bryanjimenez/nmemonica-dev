"use strict";(self.webpackChunknmemonica=self.webpackChunknmemonica||[]).push([["70"],{92905:function(e,s,a){a.r(s),a.d(s,{default:function(){return R}});var l=a(69554),i=a(88729),t=a(50098),n=a(46421),c=a.n(n),r=a(59914),d=a(81722),m=a(5540),u=a(57673),o=a(82648),x=a(26757),h=a(20952),j=a(68883),b=a(81718),f=a(31485),p=a(22001),v=a(10599),N=a(56152),k=a(45181),g=a(86100),C=a(46329),w=a(25167),S=a(94397),y=a(40791),z=a(14691);let D=(0,r.lazy)(()=>a.e("515").then(a.bind(a,16949))),E=(0,r.lazy)(()=>a.e("839").then(a.bind(a,89454)));function R(){let e=(0,d.I0)(),{cookies:s,debug:a,localServiceURL:n,lastImport:R}=(0,v.E)(),[Z,F]=(0,r.useState)(!1),[O,_]=(0,r.useState)(!1),[B,T]=(0,r.useState)(!1),[q,H]=(0,r.useState)(!1),[I,K]=(0,r.useState)(!1),[L,P]=(0,r.useState)(!1),[U,W]=(0,r.useState)(!1),[A,G]=(0,r.useState)(!1);(0,r.useEffect)(()=>{let e=setTimeout(()=>{G(!0)},500);return()=>{clearTimeout(e)}},[]);let $=(0,r.useCallback)(()=>{if(!confirm("User edited datasets will be overwritten"))return;let s=(0,m.iD)(n);s===m.C9.Unset?e((0,N.q_)(!1)):e((0,N.q_)(!0)),e((0,y.qp)()).unwrap().then(e=>(0,x.xR)().then(s=>(0,x.sH)({db:s,store:x.pK.WORKBOOK},{key:"0",workbook:e}))).then(()=>{e((0,z.jB)()),e((0,w.k6)()),e((0,k.WF)()),e((0,C.QE)()),e((0,g.qC)()),H(!0),e((0,N.Kt)(`${["Reset","Local","GitHub"][s]}: ${new Date().toJSON()}`))})},[e,n]),J=(0,r.useCallback)(()=>{if(!!confirm("User settings will be overwritten"))e((0,N.sZ)()).then(()=>{K(!0)})},[e]),Q=(0,r.useCallback)(()=>{if(!confirm("Back up:\n - Datasets\n - Settings\n\nto local service?"))return;let s=new Promise((s,a)=>{let l;try{l=(0,f.xr)(h._)}catch(s){e((0,N.kg)("Failed settings backup",S.x6.ERROR))}if(!l){s();return}(0,y.At)(l,n).then(()=>s).catch(()=>a)});Promise.all([s,e((0,y.EX)()).unwrap().then(e=>e.map(e=>(0,y.CZ)(e,n))).then(e=>Promise.all(e))]).then(()=>{T(!0)})},[e,n]),X=(0,r.useCallback)(e=>{F(e)},[]),M=(0,r.useCallback)(e=>{_(e),!0!==e&&(H(null),T(null))},[]);return(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"mt-3 mb-1"}),(0,l.jsxs)("div",{className:"d-flex flex-row justify-content-between",children:[(0,l.jsx)("div",{className:"column-1 mb-2 me-sm-2"}),(0,l.jsx)("div",{className:"column-2",children:(0,l.jsxs)("div",{className:"ps-2 d-flex flex-column align-items-end",children:[(0,l.jsx)("div",{className:"setting-block mb-2",children:(0,l.jsx)(o.Z,{disabled:!s,active:a>S.x6.OFF,action:(0,j.c)(e,N.zA),color:"default",statusText:(0,b.w_)(a,["Debug","Debug Error","Debug Warn","Debug"])})}),(0,l.jsxs)("div",{className:c()({"d-flex justify-content-end mb-2":!0,"disabled-color":U}),children:[(0,l.jsx)("p",{id:"hard-refresh",className:c()({"text-right":!0,"disabled-color":!s}),children:"Hard Refresh"}),(0,l.jsx)("div",{className:c()({"spin-a-bit":L,"disabled-color":!s,clickable:s}),style:{height:"24px"},"aria-labelledby":"hard-refresh",onClick:s?()=>{P(!0),W(!1),setTimeout(()=>{L&&(P(!1),W(!0))},3e3),(0,p.F5)()}:void 0,children:(0,l.jsx)(t.bnu,{size:24,"aria-label":"Hard Refresh"})})]})," "]})})]}),(0,l.jsx)("h3",{className:"mt-3 mb-1 fw-light",children:"External Data Source"}),(0,l.jsxs)("div",{className:"d-flex flex-column flex-sm-row justify-content-between",children:[(0,l.jsx)("div",{className:"column-1 mb-2 me-sm-2",children:(0,l.jsx)("div",{className:"mt-2 mb-2",children:[(0,l.jsx)("div",{children:"Recent import history:"},"label"),...R.map(e=>(0,l.jsx)("div",{className:"pt-1",children:e},e))]})}),(0,l.jsxs)("div",{className:"column-2",children:[(0,l.jsx)("div",{className:"mb-2",children:(0,l.jsx)(m.ZP,{onChangeInput:X,onChangeTrust:M})}),(0,l.jsxs)("div",{className:"d-flex justify-content-center",children:[(0,l.jsx)("div",{className:"px-1",children:(0,l.jsxs)(i.Z,{"aria-label":"Import Datasets",variant:"outlined",size:"small",disabled:Z||""===n||!0!==O||!0===q,onClick:$,children:[!0===q?(0,l.jsx)(t.rE2,{size:"small",className:"pe-1"}):(0,l.jsx)(t._8t,{size:"small",className:"pe-1"}),"Datasets"]})}),(0,l.jsx)("div",{className:"px-1",children:(0,l.jsxs)(i.Z,{"aria-label":"Import User Configuration",variant:"outlined",size:"small",disabled:(0,m.iD)(n)!==m.C9.LocalService||Z||""===n||!0!==O||!0===I,onClick:J,children:[!0===I?(0,l.jsx)(t.rE2,{size:"small",className:"pe-1"}):(0,l.jsx)(t._8t,{size:"small",className:"pe-1"}),"Config"]})}),(0,l.jsx)("div",{className:"px-1",children:(0,l.jsxs)(i.Z,{"aria-label":"Backup Datasets",variant:"outlined",size:"small",disabled:(0,m.iD)(n)!==m.C9.LocalService||Z||""===n||!0!==O||!0===B,onClick:Q,children:[!0===B?(0,l.jsx)(t.rE2,{size:"small",className:"pe-1"}):(0,l.jsx)(t.rG2,{size:"small",className:"pe-1"}),"Backup"]})})]})]})]}),(0,l.jsx)("div",{className:"mt-4",children:A?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(r.Suspense,{fallback:(0,l.jsx)(u.n,{addlStyle:"failed-spacerep-view"}),children:(0,l.jsx)(D,{})}),(0,l.jsx)(r.Suspense,{fallback:(0,l.jsx)(u.n,{addlStyle:"failed-furigana-view"}),children:(0,l.jsx)(E,{})})]}):(0,l.jsx)(u.n,{text:"Loading failed details ..."})})]})}}}]);
//# sourceMappingURL=70.d9e607ee.js.map